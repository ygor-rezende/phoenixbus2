{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects\\\\PhoenixBus\\\\SecondApp\\\\client\\\\src\\\\pages\\\\login.jsx\",\n  _s = $RefreshSig$();\nimport { useReducer, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Button, Snackbar, Alert, AlertTitle } from \"@mui/material\";\nimport { useCookies } from \"react-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Login = () => {\n  _s();\n  const [formData, setFormData] = useReducer((formData, newItem) => {\n    return {\n      ...formData,\n      ...newItem\n    };\n  }, {\n    userName: \"\",\n    password: \"\"\n  });\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [cookies, setCookie, removeCookie] = useCookies(null);\n  const [openSnakbar, setOpenSnakbar] = useState(false);\n  const navigate = useNavigate();\n  const doLogin = () => {\n    try {\n      login(formData.userName, formData.password);\n    } catch (error) {\n      setErrorMessage(\"Incorrect password\");\n    }\n  };\n  const login = async (userName, password) => {\n    //Hit API to pull the username to check the password\n    //const prov = \"http://localhost:8000\";\n    const response = await fetch(\"/login\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        userName,\n        password\n      })\n    });\n    const data = await response.json();\n    console.log(data);\n    //if an error happens when signing up set the error\n    if (data.detail) {\n      setErrorMessage(data.detail);\n      setOpenSnakbar(true);\n    } else {\n      //if no error set cookies\n      setErrorMessage(null);\n      const date = Date.now();\n      setCookie(\"Username\", data.username, {\n        expires: new Date(date + 60000)\n      });\n      console.log(date);\n      setCookie(\"AuthToken\", data.token);\n      setCookie(\"UserType\", data.usertype);\n      navigate(\"/home\");\n      //set props\n      //props.user({ name: data.username, type: data.usertype, isAuth: true });\n      //reload the page\n      //window.location.reload();\n    }\n  };\n\n  const handleClose = (event, reason) => {\n    if (reason === \"clickaway\") {\n      return;\n    }\n    setOpenSnakbar(false);\n  };\n  const keyEnterHandler = e => {\n    if (e.key === \"Enter\") document.getElementById(\"loginButton\").focus();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"page\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Phoenix Bus - Login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inputs\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"userName\",\n          type: \"text\",\n          value: formData.userName,\n          onChange: e => setFormData({\n            userName: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"password\",\n          type: \"password\",\n          value: formData.password,\n          onChange: e => setFormData({\n            password: e.target.value\n          }),\n          onKeyDownCapture: keyEnterHandler\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"button\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          id: \"loginButton\",\n          variant: \"outlined\",\n          onClick: doLogin,\n          children: \"Log in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n        open: errorMessage && openSnakbar,\n        autoHideDuration: 5000,\n        onClose: handleClose,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          severity: \"error\",\n          onClose: handleClose,\n          children: [/*#__PURE__*/_jsxDEV(AlertTitle, {\n            children: \"Error\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 13\n          }, this), errorMessage]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"01XTqyiX6b2UPaa2R++D7SqnJjE=\", false, function () {\n  return [useCookies, useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["useReducer","useState","useNavigate","Button","Snackbar","Alert","AlertTitle","useCookies","jsxDEV","_jsxDEV","Login","_s","formData","setFormData","newItem","userName","password","errorMessage","setErrorMessage","cookies","setCookie","removeCookie","openSnakbar","setOpenSnakbar","navigate","doLogin","login","error","response","fetch","method","headers","body","JSON","stringify","data","json","console","log","detail","date","Date","now","username","expires","token","usertype","handleClose","event","reason","keyEnterHandler","e","key","document","getElementById","focus","className","children","fileName","_jsxFileName","lineNumber","columnNumber","id","type","value","onChange","target","onKeyDownCapture","variant","onClick","open","autoHideDuration","onClose","severity","_c","$RefreshReg$"],"sources":["C:/Projects/PhoenixBus/SecondApp/client/src/pages/login.jsx"],"sourcesContent":["import { useReducer, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { Button, Snackbar, Alert, AlertTitle } from \"@mui/material\";\r\nimport { useCookies } from \"react-cookie\";\r\n\r\nconst Login = () => {\r\n  const [formData, setFormData] = useReducer(\r\n    (formData, newItem) => {\r\n      return { ...formData, ...newItem };\r\n    },\r\n    { userName: \"\", password: \"\" }\r\n  );\r\n\r\n  const [errorMessage, setErrorMessage] = useState(null);\r\n  const [cookies, setCookie, removeCookie] = useCookies(null);\r\n  const [openSnakbar, setOpenSnakbar] = useState(false);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const doLogin = () => {\r\n    try {\r\n      login(formData.userName, formData.password);\r\n    } catch (error) {\r\n      setErrorMessage(\"Incorrect password\");\r\n    }\r\n  };\r\n\r\n  const login = async (userName, password) => {\r\n    //Hit API to pull the username to check the password\r\n    //const prov = \"http://localhost:8000\";\r\n    const response = await fetch(\"/login\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ userName, password }),\r\n    });\r\n\r\n    const data = await response.json();\r\n    console.log(data);\r\n    //if an error happens when signing up set the error\r\n    if (data.detail) {\r\n      setErrorMessage(data.detail);\r\n      setOpenSnakbar(true);\r\n    } else {\r\n      //if no error set cookies\r\n      setErrorMessage(null);\r\n      const date = Date.now();\r\n      setCookie(\"Username\", data.username, {\r\n        expires: new Date(date + 60000),\r\n      });\r\n      console.log(date);\r\n      setCookie(\"AuthToken\", data.token);\r\n      setCookie(\"UserType\", data.usertype);\r\n      navigate(\"/home\");\r\n      //set props\r\n      //props.user({ name: data.username, type: data.usertype, isAuth: true });\r\n      //reload the page\r\n      //window.location.reload();\r\n    }\r\n  };\r\n\r\n  const handleClose = (event, reason) => {\r\n    if (reason === \"clickaway\") {\r\n      return;\r\n    }\r\n    setOpenSnakbar(false);\r\n  };\r\n\r\n  const keyEnterHandler = (e) => {\r\n    if (e.key === \"Enter\") document.getElementById(\"loginButton\").focus();\r\n  };\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <h2>Phoenix Bus - Login</h2>\r\n      <div className=\"inputs\">\r\n        <div className=\"input\">\r\n          <input\r\n            id=\"userName\"\r\n            type=\"text\"\r\n            value={formData.userName}\r\n            onChange={(e) => setFormData({ userName: e.target.value })}\r\n          />\r\n        </div>\r\n        <div className=\"input\">\r\n          <input\r\n            id=\"password\"\r\n            type=\"password\"\r\n            value={formData.password}\r\n            onChange={(e) => setFormData({ password: e.target.value })}\r\n            onKeyDownCapture={keyEnterHandler}\r\n          />\r\n        </div>\r\n        <p></p>\r\n        <div className=\"button\">\r\n          <Button id=\"loginButton\" variant=\"outlined\" onClick={doLogin}>\r\n            Log in\r\n          </Button>\r\n        </div>\r\n        <Snackbar\r\n          open={errorMessage && openSnakbar}\r\n          autoHideDuration={5000}\r\n          onClose={handleClose}\r\n        >\r\n          <Alert severity=\"error\" onClose={handleClose}>\r\n            <AlertTitle>Error</AlertTitle>\r\n            {errorMessage}\r\n          </Alert>\r\n        </Snackbar>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}